--What artists does each user listen to?

SELECT display_name, artist_name
FROM topartists, listeners,artists
WHERE topartists.listener_id = listeners.listener_id and topartists.artist_id=artists.artist_id;

 display_name  |              artist_name
---------------+----------------------------------------
 Caroline Wang | Taylor Swift
 Elise Brown   | Steven Universe
 Elise Brown   | Jonathan McReynolds
 Elise Brown   | Queen
 Elise Brown   | Weezer
 Elise Brown   | Chance the Rapper
 Elise Brown   | Kirk Franklin
 Elise Brown   | The Walls Group
 Elise Brown   | Donald Lawrence & The Tri-City Singers
 Elise Brown   | Dexter Walker & Zion Movement
 Elise Brown   | Mary Mary
 Elise Brown   | Tye Tribbett
 Elise Brown   | Childish Gambino
 Elise Brown   | Fred Hammond
 Elise Brown   | Donnie McClurkin
 Elise Brown   | Yolanda Adams
 Elise Brown   | Lin-Manuel Miranda
 Elise Brown   | Tauren Wells
 Elise Brown   | Kesha
 bnativi17     | Different Heaven
 bnativi17     | Pegboard Nerds
 bnativi17     | Hellberg
(22 rows)

--Which artists have a popularity above 50?

SELECT artist_name
FROM artists
WHERE artist_pop>=50;
     artist_name
----------------------
 Taylor Swift
 Shawn Mendes
 Lil Loaded
 King Von
 Young T & Bugsey
 Adam Lambert
 Rico Nasty
 Shordie Shordie
 K CAMP
 Ari Lennox
 6LACK
 Tink
 NLE Choppa
 Roddy Ricch
 Perfume Genius
 DVBBS
 Tauren Wells
 Tye Tribbett
 Arctic Monkeys
 Phillip Phillips
 Todd Dulaney
 Jonathan McReynolds
 Chance the Rapper
 BJ The Chicago Kid
 Smash Mouth
 Action Bronson
 Queen
 Lady Gaga
 Rufus Wainwright
 Anthem Lights
 Steven Universe
 Weezer
 Kirk Franklin
 Mary Mary
 Childish Gambino
 Fred Hammond
 Donnie McClurkin
 Yolanda Adams
 Lin-Manuel Miranda
 Kesha
 Panda Eyes
 Teminite
 S3RL
 Lewis Capaldi
 Deaf Kev
 Tristam
 Braken
 Electro-Light
 Alan Walker
 Different Heaven
  Billie Eilish
 Adventure Club
 Yuna
 Nitro Fun
 Pegboard Nerds
 Ludwig van Beethoven
 Hellberg
 Cozi Zuehlsdorff
 Stonebank
(59 rows)

--What is the artist id, popularity, and number of followers of a particular listener's top artists in the short time span?

select a1.artist_id, a1.artist_pop, a1.num_followers
from artists as a1
where a1.artist_id in
    (select a2.artist_id
     from topartists as a2
     where listener_id='314xcqarki42gnkosjtfplluumya' and time_span='short_term'
    );
       artist_id        | artist_pop | num_followers
------------------------+------------+---------------
 06HL4z0CvFAxyc27GXpf02 |         91 |      27964509
(1 row)

--What are the genre and characteristics of a particular user's top tracks in the short term?

select *
from albumhasgenre
natural join
    (select *
    from tracks as t1
    natural join albumcontainstrack
    where t1.track_id in (
                 select t2.track_id
                  from toptracks as t2
                  where listener_id='314xcqarki42gnkosjtfplluumya' and time_span='short_term')
                  ) as track_album_info
where albumhasgenre.album_id = track_album_info.track_id;
 album_id | genre_name | track_id | track_name | track_pop | preview_url | acousticness | danceability | energy | valence | loudness | tempo | instrumentalness | speechiness | mode | time_signature | liveness
----------+------------+----------+------------+-----------+-------------+--------------+--------------+--------+---------+----------+-------+------------------+-------------+------+----------------+----------
(0 rows)